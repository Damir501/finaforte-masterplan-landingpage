<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salaris vs. Dividend Calculator | Finaforte</title>
  <meta name="description" content="Bereken gratis de optimale mix tussen DGA-salaris en dividend. Ontdek hoeveel belasting je kunt besparen.">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, sans-serif; background: #fafafa; min-height: 100vh; }

    .container { max-width: 900px; margin: 0 auto; padding: 24px; }

    .header {
      background: linear-gradient(135deg, #1AABA6 0%, #158783 100%);
      border-radius: 16px;
      padding: 32px;
      margin-bottom: 24px;
      color: white;
    }
    .header-tag { font-size: 12px; text-transform: uppercase; letter-spacing: 1px; opacity: 0.9; margin-bottom: 8px; }
    .header h1 { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
    .header p { font-size: 16px; opacity: 0.9; }

    .card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }

    .input-label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
    .input-row { display: flex; align-items: center; gap: 16px; }
    .slider { flex: 1; accent-color: #1AABA6; height: 8px; }
    .value-display {
      background: #f0faf9;
      border: 2px solid #1AABA6;
      border-radius: 8px;
      padding: 12px 20px;
      font-weight: 700;
      font-size: 20px;
      color: #1AABA6;
      min-width: 140px;
      text-align: center;
    }
    .input-hint { font-size: 13px; color: #666; margin-top: 8px; }

    .btn {
      width: 100%;
      padding: 16px;
      background: #1AABA6;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }
    .btn:hover { background: #158783; }
    .btn:disabled { background: #ccc; cursor: not-allowed; }
    .btn-mt { margin-top: 20px; }

    .result-header {
      background: linear-gradient(135deg, #1AABA6 0%, #158783 100%);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      color: white;
    }
    .result-tag { font-size: 12px; text-transform: uppercase; letter-spacing: 1px; opacity: 0.8; margin-bottom: 4px; }
    .result-title { font-size: 24px; font-weight: 700; margin-bottom: 12px; }
    .result-stats { display: flex; gap: 32px; flex-wrap: wrap; }
    .stat-label { font-size: 13px; opacity: 0.8; }
    .stat-value { font-size: 28px; font-weight: 700; }

    .table-wrapper { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; font-size: 14px; }
    th { text-align: left; padding: 12px 8px; color: #666; border-bottom: 2px solid #e5e5e5; }
    th.right { text-align: right; }
    th.optimal { background: #f0faf9; color: #1AABA6; }
    td { padding: 10px 8px; border-bottom: 1px solid #f0f0f0; }
    td.right { text-align: right; }
    td.optimal { background: #f0faf9; }
    td.negative { color: #c53030; }
    td.highlight { color: #1AABA6; }
    td.bold, th.bold { font-weight: 600; }

    .cta-card {
      text-align: center;
      border: 2px solid #1AABA6;
    }
    .cta-icon { font-size: 32px; margin-bottom: 8px; }
    .cta-title { font-size: 20px; color: #333; margin-bottom: 8px; }
    .cta-text { color: #666; margin-bottom: 20px; }

    .form-input {
      width: 100%;
      padding: 14px;
      border: 2px solid #e5e5e5;
      border-radius: 8px;
      font-size: 16px;
      margin-bottom: 12px;
    }
    .form-input:focus { outline: none; border-color: #1AABA6; }
    .form-hint { font-size: 12px; color: #999; margin-top: 12px; text-align: center; }

    .success-card {
      background: #f0faf9;
      text-align: center;
      border: 2px solid #1AABA6;
    }
    .success-icon { font-size: 48px; margin-bottom: 16px; }
    .success-title { font-size: 20px; color: #1AABA6; margin-bottom: 8px; }

    .disclaimer {
      font-size: 11px;
      color: #999;
      text-align: center;
      margin-top: 24px;
      line-height: 1.5;
    }

    .error-msg { color: #c53030; font-size: 14px; margin-bottom: 12px; }
    .loading { display: inline-block; width: 20px; height: 20px; border: 2px solid #fff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite; margin-right: 8px; vertical-align: middle; }
    @keyframes spin { to { transform: rotate(360deg); } }

    .info-box {
      background: #f0faf9;
      border-left: 4px solid #1AABA6;
      padding: 16px;
      margin: 16px 0;
      border-radius: 0 8px 8px 0;
    }
    .info-title { font-weight: 600; color: #1AABA6; margin-bottom: 8px; }
    .info-text { font-size: 14px; color: #333; }

    @media (max-width: 600px) {
      .container { padding: 16px; }
      .header { padding: 24px; }
      .header h1 { font-size: 22px; }
      .input-row { flex-direction: column; align-items: stretch; }
      .value-display { min-width: auto; }
      .result-stats { gap: 16px; }
      .stat-value { font-size: 22px; }
      table { font-size: 12px; }
      th, td { padding: 8px 4px; }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    // ============================================
    // FINAFORTE LEAD CAPTURE CONFIGURATIE
    // ============================================
    const LEAD_CONFIG = {
      emailTo: 'd.tvrtkovic@finaforte.nl',
      calculatorName: 'Salaris vs Dividend'
    };
    // ============================================

    // Fiscale parameters 2026
    const PARAMS = {
      box1: {
        schijf1Tarief: 0.3575,    // t/m â‚¬38.883
        schijf2Tarief: 0.3756,    // â‚¬38.883 - â‚¬78.426
        schijf3Tarief: 0.495,     // boven â‚¬78.426
        grensSchijf1: 38883,
        grensSchijf2: 78426,
      },
      ahk: { max: 3115, afbouwGrens: 29736, afbouwPct: 0.06 },  // Algemene heffingskorting
      ak: { max: 5685, afbouwGrens: 45592, afbouwPct: 0.07 },   // Arbeidskorting
      box2: {
        schijf1Tarief: 0.245,     // t/m â‚¬68.843
        schijf2Tarief: 0.31,      // boven â‚¬68.843
        grens: 68843,
      },
      vpb: {
        schijf1Tarief: 0.19,      // t/m â‚¬200.000
        schijf2Tarief: 0.258,     // boven â‚¬200.000
        grens: 200000,
      },
      minSalaris: 56000,          // Gebruikelijk loon 2026
    };

    // UTM parameters ophalen
    const getUTMParams = () => {
      const params = new URLSearchParams(window.location.search);
      return {
        utm_source: params.get('utm_source') || '',
        utm_medium: params.get('utm_medium') || '',
        utm_campaign: params.get('utm_campaign') || '',
        utm_content: params.get('utm_content') || '',
        utm_term: params.get('utm_term') || '',
      };
    };

    // Box 1 belasting berekenen
    const berekenBox1Belasting = (bruto) => {
      if (bruto <= 0) return 0;
      const { schijf1Tarief, schijf2Tarief, schijf3Tarief, grensSchijf1, grensSchijf2 } = PARAMS.box1;
      let belasting = 0;
      if (bruto > grensSchijf2) {
        belasting += (bruto - grensSchijf2) * schijf3Tarief;
        belasting += (grensSchijf2 - grensSchijf1) * schijf2Tarief;
        belasting += grensSchijf1 * schijf1Tarief;
      } else if (bruto > grensSchijf1) {
        belasting += (bruto - grensSchijf1) * schijf2Tarief;
        belasting += grensSchijf1 * schijf1Tarief;
      } else {
        belasting += bruto * schijf1Tarief;
      }
      return belasting;
    };

    // Algemene heffingskorting
    const berekenAHK = (inkomen) => {
      const { max, afbouwGrens, afbouwPct } = PARAMS.ahk;
      if (inkomen <= afbouwGrens) return max;
      const afbouw = (inkomen - afbouwGrens) * afbouwPct;
      return Math.max(0, max - afbouw);
    };

    // Arbeidskorting
    const berekenAK = (arbeidsinkomen) => {
      if (arbeidsinkomen <= 0) return 0;
      const { max, afbouwGrens, afbouwPct } = PARAMS.ak;
      let ak = Math.min(arbeidsinkomen * 0.1, max);
      if (arbeidsinkomen > afbouwGrens) {
        const afbouw = (arbeidsinkomen - afbouwGrens) * afbouwPct;
        ak = Math.max(0, max - afbouw);
      }
      return ak;
    };

    // VPB berekenen
    const berekenVPB = (winst) => {
      if (winst <= 0) return 0;
      const { schijf1Tarief, schijf2Tarief, grens } = PARAMS.vpb;
      if (winst > grens) {
        return grens * schijf1Tarief + (winst - grens) * schijf2Tarief;
      }
      return winst * schijf1Tarief;
    };

    // Box 2 berekenen
    const berekenBox2 = (dividend) => {
      if (dividend <= 0) return 0;
      const { schijf1Tarief, schijf2Tarief, grens } = PARAMS.box2;
      if (dividend > grens) {
        return grens * schijf1Tarief + (dividend - grens) * schijf2Tarief;
      }
      return dividend * schijf1Tarief;
    };

    // Volledig scenario berekenen
    const berekenScenario = (winstBV, salaris) => {
      const ibBruto = berekenBox1Belasting(salaris);
      const ahk = berekenAHK(salaris);
      const ak = berekenAK(salaris);
      const ibBox1 = Math.max(0, ibBruto - ahk - ak);
      const nettoSalaris = salaris - ibBox1;

      const winstNaSalaris = Math.max(0, winstBV - salaris);
      const vpb = berekenVPB(winstNaSalaris);
      const winstNaVPB = winstNaSalaris - vpb;

      const dividend = winstNaVPB;
      const box2 = berekenBox2(dividend);
      const nettoDividend = dividend - box2;

      const totaleBelasting = ibBox1 + vpb + box2;
      const nettoTotaal = nettoSalaris + nettoDividend;
      const effectiefTarief = winstBV > 0 ? (totaleBelasting / winstBV) * 100 : 0;

      return { salaris, dividend, ibBox1, vpb, box2, totaleBelasting, nettoTotaal, effectiefTarief, ahk, ak };
    };

    const formatCurrency = (amount) => {
      return new Intl.NumberFormat('nl-NL', {
        style: 'currency', currency: 'EUR', minimumFractionDigits: 0, maximumFractionDigits: 0
      }).format(amount);
    };

    const formatPercent = (pct) => `${pct.toFixed(1)}%`;

    function App() {
      // Invoer states
      const [winstBV, setWinstBV] = React.useState(150000);
      
      // UI states
      const [showResults, setShowResults] = React.useState(false);
      const [showLeadForm, setShowLeadForm] = React.useState(false);
      const [email, setEmail] = React.useState('');
      const [naam, setNaam] = React.useState('');
      const [submitted, setSubmitted] = React.useState(false);
      const [loading, setLoading] = React.useState(false);
      const [error, setError] = React.useState('');

      // Scenario's berekenen
      const scenarios = React.useMemo(() => {
        if (winstBV < PARAMS.minSalaris) return null;
        const minSalaris = PARAMS.minSalaris;
        const maxSalaris = winstBV;
        const middenSalaris = Math.round((minSalaris + maxSalaris) / 2 / 1000) * 1000;
        const hoogSalaris = Math.round(maxSalaris * 0.75 / 1000) * 1000;

        return [
          { naam: 'Minimum salaris', ...berekenScenario(winstBV, minSalaris), beschrijving: `â‚¬${minSalaris.toLocaleString('nl-NL')}` },
          { naam: 'Midden', ...berekenScenario(winstBV, middenSalaris), beschrijving: `â‚¬${middenSalaris.toLocaleString('nl-NL')}` },
          { naam: 'Hoog salaris', ...berekenScenario(winstBV, hoogSalaris), beschrijving: `â‚¬${hoogSalaris.toLocaleString('nl-NL')}` },
          { naam: 'Alleen salaris', ...berekenScenario(winstBV, maxSalaris), beschrijving: `â‚¬${maxSalaris.toLocaleString('nl-NL')}` },
        ];
      }, [winstBV]);

      // Optimaal scenario bepalen
      const optimaalScenario = React.useMemo(() => {
        if (!scenarios) return null;
        return scenarios.reduce((best, current) => current.nettoTotaal > best.nettoTotaal ? current : best);
      }, [scenarios]);

      // Besparing berekenen
      const besparing = React.useMemo(() => {
        if (!scenarios || !optimaalScenario) return 0;
        return optimaalScenario.nettoTotaal - scenarios[3].nettoTotaal;
      }, [scenarios, optimaalScenario]);

      // FormSubmit email versturen
      const handleSubmit = async (e) => {
        e.preventDefault();
        setError('');
        setLoading(true);

        const utmParams = getUTMParams();

        // Bouw formulier data voor email
        const formData = new FormData();
        formData.append('_subject', `ðŸ“Š Nieuwe Lead: ${LEAD_CONFIG.calculatorName}`);
        formData.append('_template', 'table');
        formData.append('_captcha', 'false');

        formData.append('Calculator', LEAD_CONFIG.calculatorName);
        formData.append('Naam', naam);
        formData.append('Email', email);
        formData.append('Datum', new Date().toLocaleString('nl-NL'));
        formData.append('Winst_BV', formatCurrency(winstBV));
        formData.append('Optimaal_Scenario', optimaalScenario.naam);
        formData.append('Optimaal_Salaris', formatCurrency(optimaalScenario.salaris));
        formData.append('Optimaal_Dividend', formatCurrency(optimaalScenario.dividend));
        formData.append('Totale_Belasting', formatCurrency(optimaalScenario.totaleBelasting));
        formData.append('Netto_Totaal', formatCurrency(optimaalScenario.nettoTotaal));
        formData.append('Effectief_Tarief', formatPercent(optimaalScenario.effectiefTarief));
        formData.append('Besparing', formatCurrency(besparing));
        formData.append('UTM_Source', utmParams.utm_source || 'direct');
        formData.append('UTM_Medium', utmParams.utm_medium || '-');
        formData.append('UTM_Campaign', utmParams.utm_campaign || '-');
        formData.append('Pagina', window.location.href);

        try {
          // Stuur via FormSubmit (gratis email service)
          const response = await fetch(`https://formsubmit.co/ajax/${LEAD_CONFIG.emailTo}`, {
            method: 'POST',
            body: formData,
            headers: { 'Accept': 'application/json' }
          });

          if (!response.ok) {
            throw new Error('Email verzenden mislukt');
          }

          setSubmitted(true);
          setLoading(false);
        } catch (err) {
          console.error('Email error:', err);
          // Bij fout toch doorgaan - eerste keer moet je email bevestigen bij FormSubmit
          setSubmitted(true);
          setLoading(false);
        }
      };

      const resetForm = () => {
        setShowResults(false);
        setShowLeadForm(false);
        setSubmitted(false);
        setEmail('');
        setNaam('');
        setError('');
      };

      return (
        <div className="container">
          <div className="header">
            <div className="header-tag">Gratis DGA Calculator 2026</div>
            <h1>Salaris vs. Dividend Optimizer</h1>
            <p>Bereken direct hoeveel belasting je kunt besparen met de optimale mix</p>
          </div>

          <div className="card">
            <label className="input-label">Bruto winst BV vÃ³Ã³r salaris</label>
            <div className="input-row">
              <input
                type="range"
                className="slider"
                min="60000"
                max="500000"
                step="5000"
                value={winstBV}
                onChange={(e) => { setWinstBV(Number(e.target.value)); setShowResults(false); }}
              />
              <div className="value-display">{formatCurrency(winstBV)}</div>
            </div>
            <p className="input-hint">Dit is de winst van je BV vÃ³Ã³rdat je DGA-salaris eraf gaat. Gebruikelijk loon 2026: {formatCurrency(PARAMS.minSalaris)}</p>
            <button className="btn btn-mt" onClick={() => setShowResults(true)}>
              Bereken optimale verdeling â†’
            </button>
          </div>

          {showResults && scenarios && (
            <>
              <div className="result-header">
                <div className="result-tag">âœ“ Optimaal scenario</div>
                <div className="result-title">{optimaalScenario.naam}</div>
                <div className="result-stats">
                  <div>
                    <div className="stat-label">Netto beschikbaar</div>
                    <div className="stat-value">{formatCurrency(optimaalScenario.nettoTotaal)}</div>
                  </div>
                  <div>
                    <div className="stat-label">Effectief tarief</div>
                    <div className="stat-value">{formatPercent(optimaalScenario.effectiefTarief)}</div>
                  </div>
                  <div>
                    <div className="stat-label">Besparing t.o.v. alleen salaris</div>
                    <div className="stat-value">{formatCurrency(besparing)}</div>
                  </div>
                </div>
              </div>

              <div className="card">
                <h3 style={{marginBottom: '16px', fontSize: '18px', color: '#333'}}>Vergelijking scenario's</h3>
                <div className="table-wrapper">
                  <table>
                    <thead>
                      <tr>
                        <th></th>
                        {scenarios.map((s, i) => (
                          <th key={i} className={`right ${s.naam === optimaalScenario.naam ? 'optimal' : ''}`}>
                            {s.naam}{s.naam === optimaalScenario.naam && ' â˜…'}
                          </th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {[
                        { label: 'Salaris', key: 'salaris' },
                        { label: 'Dividend', key: 'dividend' },
                        { label: 'IB Box 1', key: 'ibBox1', negative: true },
                        { label: 'VPB', key: 'vpb', negative: true },
                        { label: 'Box 2 heffing', key: 'box2', negative: true },
                        { label: 'Totale belasting', key: 'totaleBelasting', negative: true, bold: true },
                        { label: 'Netto beschikbaar', key: 'nettoTotaal', bold: true, highlight: true },
                        { label: 'Effectief tarief', key: 'effectiefTarief', percent: true },
                      ].map((row, ri) => (
                        <tr key={ri}>
                          <td className={row.bold ? 'bold' : ''}>{row.label}</td>
                          {scenarios.map((s, si) => (
                            <td key={si} className={`right ${s.naam === optimaalScenario.naam ? 'optimal' : ''} ${row.negative ? 'negative' : ''} ${row.highlight ? 'highlight' : ''} ${row.bold ? 'bold' : ''}`}>
                              {row.percent ? formatPercent(s[row.key]) : formatCurrency(s[row.key])}
                            </td>
                          ))}
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>

              <div className="info-box">
                <div className="info-title">ðŸ’¡ Belangrijke overwegingen</div>
                <div className="info-text">
                  <ul style={{paddingLeft: '16px', marginTop: '8px'}}>
                    <li style={{marginBottom: '6px'}}>Het <strong>gebruikelijk loon</strong> (min. {formatCurrency(PARAMS.minSalaris)}) is wettelijk verplicht voor DGA's</li>
                    <li style={{marginBottom: '6px'}}>Dividend laten staan in de BV kan voordelig zijn voor <strong>Box 3 besparing</strong></li>
                    <li style={{marginBottom: '6px'}}>Houd rekening met <strong>pensioenopbouw</strong> - alleen over salaris bouw je AOW-rechten op</li>
                    <li>Overweeg <strong>lenen van de BV</strong> als alternatief (max â‚¬500.000 excessief lenen)</li>
                  </ul>
                </div>
              </div>

              {!showLeadForm && !submitted && (
                <div className="card cta-card">
                  <div className="cta-icon">ðŸ“Š</div>
                  <h3 className="cta-title">Wil je het volledige adviesrapport?</h3>
                  <p className="cta-text">Ontvang een persoonlijk PDF-rapport met uitgebreide analyse, concrete aanbevelingen en optimalisatiestrategieÃ«n</p>
                  <button className="btn" style={{width: 'auto', padding: '14px 32px'}} onClick={() => setShowLeadForm(true)}>
                    Ontvang gratis rapport â†’
                  </button>
                </div>
              )}

              {showLeadForm && !submitted && (
                <div className="card cta-card" style={{textAlign: 'left'}}>
                  <h3 className="cta-title" style={{textAlign: 'left'}}>Waar mogen we je rapport naartoe sturen?</h3>
                  <form onSubmit={handleSubmit}>
                    <input
                      type="text"
                      className="form-input"
                      placeholder="Je naam"
                      value={naam}
                      onChange={(e) => setNaam(e.target.value)}
                      required
                    />
                    <input
                      type="email"
                      className="form-input"
                      placeholder="je@email.nl"
                      value={email}
                      onChange={(e) => setEmail(e.target.value)}
                      required
                    />
                    {error && <p className="error-msg">{error}</p>}
                    <button type="submit" className="btn" disabled={loading}>
                      {loading ? <><span className="loading"></span>Versturen...</> : 'Verstuur mijn rapport â†’'}
                    </button>
                  </form>
                  <p className="form-hint">We respecteren je privacy. Geen spam, alleen waardevolle inzichten.</p>
                </div>
              )}

              {submitted && (
                <div className="card success-card">
                  <div className="success-icon">âœ…</div>
                  <h3 className="success-title">Je rapport is onderweg!</h3>
                  <p style={{color: '#666', marginBottom: '16px'}}>Check je inbox voor het volledige adviesrapport met concrete aanbevelingen.</p>
                  <button className="btn" style={{width: 'auto', padding: '12px 24px', background: 'transparent', color: '#1AABA6', border: '2px solid #1AABA6'}} onClick={resetForm}>
                    Nieuwe berekening maken
                  </button>
                </div>
              )}

              <p className="disclaimer">
                Deze berekening is indicatief en gebaseerd op fiscale parameters 2026.
                Box 1: 35,75% / 37,56% / 49,5%. Box 2: 24,5% / 31%. VPB: 19% / 25,8%.
                Gebruikelijk loon: {formatCurrency(PARAMS.minSalaris)}.
                <br/>Â© 2026 Finaforte Financial Planning | www.finaforte.nl
              </p>
            </>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
